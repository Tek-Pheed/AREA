"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6894],{6894:(J,w,u)=>{u.r(w),u.d(w,{EditeurPageModule:()=>U});var h=u(177),c=u(4742),C=u(4341),m=u(8986),e=u(4438);const S=["editModal"];function k(s,r){if(1&s&&(e.j41(0,"ion-label"),e.EFF(1),e.k0s()),2&s){const o=e.XpG().$implicit;e.R7$(),e.JRh(o.fieldDescription)}}function E(s,r){if(1&s&&e.nrm(0,"ion-datetime-button",19),2&s){const o=e.XpG().$implicit;e.Y8G("datetime",o.fieldID)}}function y(s,r){if(1&s){const o=e.RV6();e.j41(0,"ion-datetime",21),e.mxI("ngModelChange",function(t){e.eBV(o);const n=e.XpG(2).$implicit;return e.DH7(n.fieldValue,t)||(n.fieldValue=t),e.Njj(t)}),e.k0s()}if(2&s){const o=e.XpG(2).$implicit;e.Y8G("id",o.fieldID)("showDefaultButtons",!0),e.R50("ngModel",o.fieldValue)}}function x(s,r){1&s&&(e.j41(0,"ion-modal",20),e.DNE(1,y,1,3,"ng-template"),e.k0s()),2&s&&e.Y8G("keepContentsMounted",!0)}function R(s,r){if(1&s){const o=e.RV6();e.j41(0,"ion-toggle",22),e.mxI("ngModelChange",function(t){e.eBV(o);const n=e.XpG().$implicit;return e.DH7(n.fieldValue,t)||(n.fieldValue=t),e.Njj(t)}),e.EFF(1),e.k0s()}if(2&s){const o=e.XpG().$implicit;e.R50("ngModel",o.fieldValue),e.R7$(),e.JRh(o.fieldDescription)}}function O(s,r){if(1&s){const o=e.RV6();e.j41(0,"ion-input",23),e.mxI("ngModelChange",function(t){e.eBV(o);const n=e.XpG().$implicit;return e.DH7(n.fieldValue,t)||(n.fieldValue=t),e.Njj(t)}),e.bIt("click",function(){e.eBV(o);const t=e.XpG().$implicit,n=e.XpG(2);return e.Njj(n.setFocusElement(t))}),e.k0s()}if(2&s){const o=e.XpG().$implicit;e.FS9("label",o.fieldDescription),e.FS9("placeholder",o.fieldValue),e.R50("ngModel",o.fieldValue)}}function P(s,r){if(1&s&&(e.j41(0,"ion-item"),e.DNE(1,k,2,1,"ion-label",11)(2,E,1,1,"ion-datetime-button",15)(3,x,2,1,"ion-modal",16)(4,R,2,2,"ion-toggle",17),e.nrm(5,"br")(6,"br"),e.DNE(7,O,1,3,"ion-input",18),e.k0s()),2&s){const o=r.$implicit;e.R7$(),e.Y8G("ngIf","datetime"===o.fieldType),e.R7$(),e.Y8G("ngIf","datetime"===o.fieldType),e.R7$(),e.Y8G("ngIf","datetime"===o.fieldType),e.R7$(),e.Y8G("ngIf","bool"===o.fieldType),e.R7$(3),e.Y8G("ngIf","bool"!==o.fieldType&&"datetime"!==o.fieldType)}}function F(s,r){1&s&&(e.j41(0,"h4"),e.EFF(1,"Available Variables:"),e.k0s())}function D(s,r){if(1&s){const o=e.RV6();e.j41(0,"ion-chip",24),e.bIt("click",function(){const t=e.eBV(o).$implicit,n=e.XpG(2);return e.Njj(n.addVariableToField(t.value))}),e.j41(1,"ion-avatar"),e.nrm(2,"img",25),e.k0s(),e.j41(3,"ion-label"),e.EFF(4),e.k0s()()}if(2&s){const o=r.$implicit;e.Y8G("outline",!0),e.R7$(2),e.FS9("src",o.img_src,e.B4B),e.R7$(2),e.JRh(o.name)}}function T(s,r){if(1&s){const o=e.RV6();e.nrm(0,"img",3),e.j41(1,"div",4),e.nrm(2,"img",5),e.j41(3,"div",6)(4,"p"),e.EFF(5),e.k0s(),e.j41(6,"p",7),e.EFF(7),e.k0s()()(),e.j41(8,"ion-content",1)(9,"div",8)(10,"div"),e.DNE(11,P,8,5,"ion-item",9),e.j41(12,"div",10),e.DNE(13,F,2,0,"h4",11)(14,D,5,3,"ion-chip",12),e.k0s()(),e.j41(15,"div",13)(16,"ion-button",14),e.bIt("click",function(){e.eBV(o);const t=e.XpG();return e.Njj(t.confirm())}),e.EFF(17,"Save"),e.k0s()()()()}if(2&s){const o=e.XpG();e.FS9("src",o.properties.img_src,e.B4B),e.R7$(2),e.FS9("src",o.properties.img_src,e.B4B),e.R7$(3),e.JRh(o.properties.name),e.R7$(2),e.JRh(o.properties.description),e.R7$(4),e.Y8G("ngForOf",o.fields),e.R7$(2),e.Y8G("ngIf",0!==o.variables.length),e.R7$(),e.Y8G("ngForOf",o.variables),e.R7$(2),e.Y8G("strong",!0)}}let b=(()=>{var s;class r{setFocusElement(i){this.focusedElementId=i}addVariableToField(i){null!=this.focusedElementId&&(this.focusedElementId.fieldValue+=`{{${i}}}`)}confirm(){var i;this.onModalClose.emit({fields:this.fields,id:this.id,modal:this.context}),this.isOpen=!1,null===(i=this.modal)||void 0===i||i.dismiss(this.fields,"confirm")}constructor(i){this.router=i,this.properties={img_src:"",name:"",description:""},this.fields=[],this.variables=[],this.id="",this.isOpen=!1,this.onModalClose=new e.bkB,this.editModal=null,this.router.events.subscribe(t=>{t instanceof m.Z&&"popstate"===t.navigationTrigger&&null!=this.editModal&&this.editModal.dismiss()})}}return(s=r).\u0275fac=function(i){return new(i||s)(e.rXU(m.Ix))},s.\u0275cmp=e.VBU({type:s,selectors:[["editor-settings"]],viewQuery:function(i,t){if(1&i&&(e.GBs(c.Sb,5),e.GBs(S,5)),2&i){let n;e.mGM(n=e.lsd())&&(t.modal=n.first),e.mGM(n=e.lsd())&&(t.editModal=n.first)}},inputs:{properties:[0,"headerProperties","properties"],fields:"fields",variables:"variables",id:"id",context:"context",isOpen:"isOpen"},outputs:{onModalClose:"onModalClose"},decls:4,vars:2,consts:[["editModal",""],[1,"ion-padding"],["animated","false",1,"ion-modal-style",3,"willDismiss","isOpen","backdropDismiss"],[1,"bgImg",3,"src"],[1,"topContent"],[1,"topImg",3,"src"],[1,"topText"],[1,"littleText"],[1,"body-container"],[4,"ngFor","ngForOf"],[1,"chipsContainer"],[4,"ngIf"],[3,"outline","click",4,"ngFor","ngForOf"],[1,"confirm"],[3,"click","strong"],[3,"datetime",4,"ngIf"],["class","dateminiModal",3,"keepContentsMounted",4,"ngIf"],["checked","f.fieldValue",3,"ngModel","ngModelChange",4,"ngIf"],["labelPlacement","stacked","type","text","value","f.fieldValue",3,"ngModel","label","placeholder","ngModelChange","click",4,"ngIf"],[3,"datetime"],[1,"dateminiModal",3,"keepContentsMounted"],[3,"ngModelChange","id","showDefaultButtons","ngModel"],["checked","f.fieldValue",3,"ngModelChange","ngModel"],["labelPlacement","stacked","type","text","value","f.fieldValue",3,"ngModelChange","click","ngModel","label","placeholder"],[3,"click","outline"],[3,"src"]],template:function(i,t){if(1&i){const n=e.RV6();e.j41(0,"ion-content",1)(1,"ion-modal",2,0),e.bIt("willDismiss",function(){return e.eBV(n),e.Njj(t.confirm())}),e.DNE(3,T,18,8,"ng-template"),e.k0s()()}2&i&&(e.R7$(),e.Y8G("isOpen",t.isOpen)("backdropDismiss",!0))},dependencies:[h.Sq,h.bT,C.BC,C.vS,c.mC,c.Jm,c.ZB,c.W9,c.A9,c.K4,c.$w,c.uz,c.he,c.BY,c.Sb,c.hB,c.Je,c.Gw],styles:[".ion-modal-style[_ngcontent-%COMP%]{--border-radius: 15px;--overflow: hidden;--position: relative;margin-top:constant(safe-area-inset-top)!important;margin-top:env(safe-area-inset-top)!important}.dateminiModal[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}ion-input[_ngcontent-%COMP%]{--highlight-color-valid: #0054e9;font-size:large}@media screen and (min-width: 1000px){.ion-modal-style[_ngcontent-%COMP%]{--border-radius: 15px;--overflow: hidden;--position: relative;--width: 40%;--height: 90%;margin-top:constant(safe-area-inset-top)!important;margin-top:env(safe-area-inset-top)!important}}.topImg[_ngcontent-%COMP%]{width:15%;aspect-ratio:1/1;margin:2.5%;border-radius:50%;border-style:solid;border-width:2px;border-color:#fff;background-color:#fff}.topContent[_ngcontent-%COMP%]{padding:1%;display:flex;background-color:#00000035}.bgImg[_ngcontent-%COMP%]{filter:blur(50px) saturate(3);transform:scale(2);width:100%;height:100%;position:absolute;z-index:-1000;opacity:.85}.topText[_ngcontent-%COMP%]{display:block;width:75%;align-content:center}p[_ngcontent-%COMP%]{align-self:center;padding:0 0 0 10px;font-size:xx-large;color:#fff;font-weight:bolder;margin:0}.littleText[_ngcontent-%COMP%]{font-size:medium}.chipsContainer[_ngcontent-%COMP%]{margin-top:5%;display:flex;flex-wrap:wrap;align-items:center;justify-content:center}.body-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;height:100%}h4[_ngcontent-%COMP%]{font-size:medium;text-align:center;width:100%;margin-bottom:10px}.confirm[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;justify-content:center}.confirm[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%}@media screen and (max-width: 600px){.topImg[_ngcontent-%COMP%]{height:80px;width:80px}}"]}),r})();var v=u(4787);const V=["editModal"];function j(s,r){if(1&s){const o=e.RV6();e.j41(0,"app-actions-cards",8),e.bIt("onCardClicked",function(t){e.eBV(o);const n=e.XpG(2);return e.Njj(n.confirm(t))}),e.k0s()}if(2&s){const o=r.$implicit,i=e.XpG(2);e.FS9("title",""==o.api_name?"Unknown Service":o.api_name),e.FS9("service",o.api_name),e.FS9("description",o.description),e.FS9("image",i.getimgsrc(o.api_name)),e.FS9("id",o.id)}}function G(s,r){if(1&s){const o=e.RV6();e.j41(0,"ion-header")(1,"h4"),e.EFF(2,"Choose an element"),e.k0s()(),e.j41(3,"ion-content")(4,"div",3)(5,"div",4),e.DNE(6,j,1,5,"app-actions-cards",5),e.k0s()()(),e.j41(7,"ion-toolbar")(8,"ion-buttons",6)(9,"ion-button",7),e.bIt("click",function(){e.eBV(o);const t=e.XpG();return e.Njj(t.cancel())}),e.EFF(10,"Cancel"),e.k0s()()()}if(2&s){const o=e.XpG();e.R7$(6),e.Y8G("ngForOf",o.areas)}}let M=(()=>{var s;class r{handleInput(i){const t=i.target.value.toLowerCase();this.searchText=t,this.inSearch=t.length>0,this.actionResults=this.areas.filter(n=>n.title.toLowerCase().indexOf(t)>-1||n.api_name.toLowerCase().indexOf(t)>-1)}getimgsrc(i){var t;let n=null===(t=this.services.find(({name:l})=>l===i))||void 0===t?void 0:t.icon_url;return null==n?"assets/favicon.png":n}cancel(){var i;this.isOpen=!1,this.onModalClose.emit({id:this.id,modal:this.context,newId:void 0}),null===(i=this.modal)||void 0===i||i.dismiss(null,"cancel")}confirm(i){var t;this.selectedElementID=i,this.onModalClose.emit({id:this.id,modal:this.context,newId:this.selectedElementID}),this.isOpen=!1,null===(t=this.modal)||void 0===t||t.dismiss(this.selectedElementID,"confirm")}constructor(i){this.router=i,this.selectedElementID="",this.services=[],this.areas=[],this.id="",this.isOpen=!1,this.onModalClose=new e.bkB,this.actionResults=[],this.inSearch=!1,this.searchText="",this.editModal=null,this.router.events.subscribe(t=>{t instanceof m.Z&&"popstate"===t.navigationTrigger&&null!=this.editModal&&this.editModal.dismiss()})}}return(s=r).\u0275fac=function(i){return new(i||s)(e.rXU(m.Ix))},s.\u0275cmp=e.VBU({type:s,selectors:[["editor-swap-settings"]],viewQuery:function(i,t){if(1&i&&(e.GBs(c.Sb,5),e.GBs(V,5)),2&i){let n;e.mGM(n=e.lsd())&&(t.modal=n.first),e.mGM(n=e.lsd())&&(t.editModal=n.first)}},inputs:{services:"services",areas:"areas",id:"id",context:"context",isOpen:"isOpen"},outputs:{onModalClose:"onModalClose"},decls:4,vars:3,consts:[["editModal",""],[1,"ion-padding"],["animated","false",3,"isOpen","backdropDismiss","animated"],[1,"chooseClass"],[1,"list"],[3,"title","service","description","image","id","onCardClicked",4,"ngFor","ngForOf"],["slot","end"],[3,"click"],[3,"onCardClicked","title","service","description","image","id"]],template:function(i,t){1&i&&(e.j41(0,"ion-content",1)(1,"ion-modal",2,0),e.DNE(3,G,11,1,"ng-template"),e.k0s()()),2&i&&(e.R7$(),e.Y8G("isOpen",t.isOpen)("backdropDismiss",!1)("animated",!1))},dependencies:[h.Sq,c.Jm,c.QW,c.W9,c.eU,c.ai,c.Sb,v.y],styles:["ion-modal[_ngcontent-%COMP%]{--border-radius: 15px;--overflow: hidden;--position: relative;--width: 90%;--height: 90%;margin-top:constant(safe-area-inset-top)!important;margin-top:env(safe-area-inset-top)!important}h4[_ngcontent-%COMP%]{align-self:center;padding-left:10px;text-align:center;font-size:x-large;font-weight:bolder}.chooseClass[_ngcontent-%COMP%]{height:100%}.list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;overflow-x:hidden;overflow-y:scroll;align-items:center;align-self:center;width:100%;height:100%;justify-content:center}"]}),r})();var A=u(536),B=u(3656);function N(s,r){if(1&s){const o=e.RV6();e.j41(0,"app-actions-cards",10),e.bIt("onCardClicked",function(){const t=e.eBV(o).$implicit,n=e.XpG();return e.Njj(n.openModalConfigureReaction(t))})("onEditClicked",function(){const t=e.eBV(o).$implicit,n=e.XpG();return e.Njj(n.openModalSwapReaction(t))})("onCardDeleted",function(){const t=e.eBV(o).$implicit,n=e.XpG();return e.Njj(n.deleteReactionById(null==t||null==t.raw?null:t.raw.id))}),e.k0s()}if(2&s){const o=r.$implicit,i=e.XpG();e.FS9("title",null==o?"Unknown Service":o.raw.title),e.FS9("description",null==o?"Please select a reaction":o.raw.description),e.FS9("service",null==o||null==o.raw?null:o.raw.api_name),e.FS9("image",i.getimgsrc(null==o||null==o.raw?null:o.raw.api_name)),e.Y8G("deletable",!0)("editable",!0)}}const $=[{path:"",component:(()=>{var s;class r{constructor(i,t,n,l,a){this.router=i,this.service=t,this.route=n,this.platform=l,this.viewContainerRef=a,this.configID="",this.token="",this.integrations=[],this.actions=[],this.reactions=[],this.date=new Date,this.configuredAction=void 0,this.configuredReactions=[void 0]}ngOnInit(){let i=window.location.href;const t=new URLSearchParams(i.split("?")[1]);this.configID=t.get("configID"),this.token=JSON.parse(JSON.stringify(localStorage.getItem("Token"))),this.token||this.router.navigate(["/home"]),this.getAllIntegrations()}selectActionById(i){if(null==i||""==i)return void(this.configuredAction=void 0);let t=this.actions.find(a=>a.id==Number(i)),n=[],l=[];if(null!=t){for(let a of t.input)n.push({fieldID:a.name,fieldType:a.type,fieldDescription:a.description,fieldValue:""});for(let a of t.labels)l.push({name:a.name,value:a.value,img_src:this.getimgsrc(t.api_name)});this.configuredAction={fields:n,raw:t,labels:l}}}swapReactionById(i,t,n=[]){let l=this.configuredReactions.findIndex(f=>(null==f?void 0:f.raw.id)==Number(i)||f==i),a=this.reactions.find(f=>f.id==Number(t)),p=[];if(null!=a){if(null!=this.configuredReactions.find(f=>(null==f?void 0:f.raw.id)==t))return void alert("Unable to select the same reaction twice !");if(null!=a.input)for(let f of a.input){var d;p.push({fieldID:f.name,fieldType:f.type,fieldDescription:f.description,fieldValue:null===(d=n.find(g=>g.name==f.name))||void 0===d?void 0:d.value})}this.configuredReactions[l]={fields:p,raw:a}}}loadValuesFromConfig(){if(null!=this.loadedConfig){for(const t of this.loadedConfig.body.action){var i;let n=null===(i=this.configuredAction)||void 0===i?void 0:i.fields.find(l=>l.fieldID==t.name);null!=n&&(n.fieldValue=t.value)}for(const t of this.loadedConfig.body.reaction){let n=this.configuredReactions.find(a=>{var p;return(null==a||null===(p=a.fields.find(d=>d.fieldID==t.name))||void 0===p?void 0:p.fieldID)==t.name});if(null==n)continue;let l=n.fields.find(a=>a.fieldID==t.name);null!=l&&(l.fieldValue=t.value)}}}getimgsrc(i){var t;if(null==i)return"assets/question-mark-round-icon.svg";let n=null===(t=this.integrations.find(({name:l})=>l===i))||void 0===t?void 0:t.icon_url;return null==n?"assets/favicon.png":n}getAllIntegrations(){let i=JSON.parse(JSON.stringify(localStorage.getItem("Token")));this.service.getAllServices(i).subscribe(t=>{this.integrations=t.data,this.integrations.splice(this.integrations.findIndex(n=>"nexus"==n.name.toLowerCase()),1),this.getAllActions()},t=>{console.error(t)})}getAllActions(){let i=JSON.parse(JSON.stringify(localStorage.getItem("Token")));this.service.getActions(i).subscribe(t=>{this.actions=t.data,this.actions.splice(this.actions.findIndex(n=>"nexus"==n.api_name.toLowerCase()),1),this.getAllReactions()},t=>{console.error(t)})}getAllReactions(){let i=JSON.parse(JSON.stringify(localStorage.getItem("Token")));this.service.getReactions(i).subscribe(t=>{this.reactions=t.data,this.reactions.splice(this.reactions.findIndex(n=>"nexus"==n.api_name.toLowerCase()),1),this.loadConfig()},t=>{console.error(t)})}loadConfig(){let i=window.location.href;this.service.getUserConfigs(this.token).subscribe(t=>{if(null!=this.configID&&null!=this.configID){let p=t.data.filter(f=>f.id==this.configID);const d=new URLSearchParams(i.split("?")[1]);if(null!=p&&null!=p[0])if(p=p[0],this.loadedConfig=p,this.selectActionById(p.actions_id),0==p.reaction_id){this.configuredReactions=[];for(const f of p.body.reaction){let g=this.reactions.find(_=>_.title==f.reaction);if(null==g)continue;let I=[];if(null!=g.input&&null!=g.input)for(let _ of g.input){var n;I.push({fieldID:_.name,fieldType:_.type,fieldDescription:_.description,fieldValue:null===(n=f.params.find(Y=>Y.name==_.name))||void 0===n?void 0:n.value})}this.configuredReactions.push({raw:g,fields:I})}}else this.swapReactionById(void 0,p.reaction_id,p.body.reaction[0].params);else null!=d.get("configID")&&(alert("Unable to find corresponding user config"),this.platform.is("desktop")?this.router.navigate(["/dashboard"]):this.router.navigate(["/tabs/home"]))}let a=new URLSearchParams(i.split("?")[1]).get("actionID");null!=a&&this.selectActionById(a),this.loadValuesFromConfig()},t=>{console.error(t)})}openModalConfigureAction(i){if(null==i)return;let t=this.viewContainerRef.createComponent(b);t.setInput("headerProperties",{name:i.raw.api_name,description:i.raw.description,img_src:this.getimgsrc(i.raw.api_name)});let n=0;for(let l of i.fields)i.fields[n].fieldValue="datetime"==l.fieldType&&""==l.fieldValue?this.date.toISOString():i.fields[n].fieldValue,n++;t.setInput("fields",i.fields),t.setInput("context",t),t.setInput("id",i.raw.id),t.instance.onModalClose.subscribe(this.actionEditModalClosed),t.instance.isOpen=!0}actionEditModalClosed(i){var t,n;null!=i&&0!=i.fields.length?(null!=this.configuredAction&&(this.configuredAction.fields=i.fields),null===(t=i.modal)||void 0===t||t.destroy()):null===(n=i.modal)||void 0===n||n.destroy()}openModalSwapAction(i){let t=this.viewContainerRef.createComponent(M);t.setInput("services",this.integrations),t.setInput("areas",this.actions),t.setInput("context",t),t.setInput("id",null==i?void 0:i.raw.id),t.instance.onModalClose.subscribe(this.actionSwapModalClosed.bind(this)),t.instance.isOpen=!0}actionSwapModalClosed(i){var t,n;null!=i&&null!=i.newId?(this.selectActionById(i.newId),null===(t=i.modal)||void 0===t||t.destroy()):null===(n=i.modal)||void 0===n||n.destroy()}openModalConfigureReaction(i){var t;if(null==i)return;let n=this.viewContainerRef.createComponent(b);n.setInput("headerProperties",{name:i.raw.api_name,description:i.raw.description,img_src:this.getimgsrc(i.raw.api_name)});let l=0;for(let a of i.fields)i.fields[l].fieldValue="datetime"==a.fieldType&&""==a.fieldValue?this.date.toISOString():i.fields[l].fieldValue,l++;n.setInput("fields",i.fields),n.setInput("context",n),n.setInput("id",i.raw.id),n.setInput("variables",null===(t=this.configuredAction)||void 0===t?void 0:t.labels),n.instance.onModalClose.subscribe(this.reactionEditModalClosed.bind(this)),n.instance.isOpen=!0}reactionEditModalClosed(i){var t,n;if(null==i||0==i.fields.length)return void(null===(n=i.modal)||void 0===n||n.destroy());let l=this.configuredReactions.find(a=>(null==a?void 0:a.raw.id)==Number(i.id));null!=l&&(l.fields=i.fields),null===(t=i.modal)||void 0===t||t.destroy()}openModalSwapReaction(i){let t=this.viewContainerRef.createComponent(M);t.setInput("services",this.integrations),t.setInput("areas",this.reactions),t.setInput("context",t),t.setInput("id",null==i?void 0:i.raw.id),t.instance.onModalClose.subscribe(this.reactionSwapModalClosed.bind(this)),t.instance.isOpen=!0}reactionSwapModalClosed(i){var t,n;null!=i&&null!=i.newId?(this.swapReactionById(i.id,i.newId),null===(t=i.modal)||void 0===t||t.destroy()):null===(n=i.modal)||void 0===n||n.destroy()}addNewReaction(){this.configuredReactions.push(void 0)}deleteReactionById(i){let t=this.configuredReactions.findIndex(n=>(null==n?void 0:n.raw.id)==i);-1!=t&&confirm("Delete this reaction ?")&&this.configuredReactions.splice(t,1)}saveConfiguration(){var i,t;if(null==this.configuredAction||null==this.configuredAction.raw||this.configuredReactions.length<=0||null!=this.configuredReactions.find(d=>null==d))return void alert("Unable to save configuration, please select the necessary items.");let n=window.location.href,a=new URLSearchParams(n.split("?")[1]).get("configID"),p={id:a,actions_id:null===(i=this.configuredAction.raw)||void 0===i?void 0:i.id,reaction_id:this.configuredReactions.length>1?0:Number(null===(t=this.configuredReactions[0])||void 0===t?void 0:t.raw.id),headers:{"Content-Type":"application/json"},method:"GET",body:{action:[],reaction:[]}};for(const d of this.configuredAction.fields)p.body.action.push({name:d.fieldID,value:String(d.fieldValue),reaction:void 0});for(const d of this.configuredReactions){if(null==d)continue;let f=[];for(let g of d.fields)f.push({name:g.fieldID,value:String(g.fieldValue)});this.configuredReactions.length>1?p.body.reaction.push({reaction:null==d?void 0:d.raw.title,params:f}):p.body.reaction=f}null==a||null==a?this.service.createNewUserConfig(this.token,p).subscribe(d=>{this.platform.is("desktop")?location.href="/dashboard":location.href="/tabs/home"},d=>{console.error(d),alert("Unable to save the configuration: "+d.error.message)}):this.service.updateUserConfig(this.token,p,Number(a)).subscribe(d=>{this.platform.is("desktop")?window.location.href="/dashboard/":window.location.href="/tabs/home"},d=>{console.error(d),alert("Unable to save the configuration: "+d.error.message)})}}return(s=r).\u0275fac=function(i){return new(i||s)(e.rXU(m.Ix),e.rXU(A.G),e.rXU(m.nX),e.rXU(B.OD),e.rXU(e.c1b))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-editeur"]],decls:17,vars:6,consts:[[1,"container-editor"],[1,"header"],["defaultHref","/","routerDirection","back","text","","icon","chevron-back-outline",1,"back-button"],[1,"container"],[3,"onCardClicked","onEditClicked","title","description","service","image","editable"],["alt","middle separator icon","src","https://uxwing.com/wp-content/themes/uxwing/download/arrow-direction/caret-right-outline-icon.png"],[1,"reactionContainer"],[3,"deletable","title","description","service","image","editable","onCardClicked","onEditClicked","onCardDeleted",4,"ngFor","ngForOf"],[1,"bottomContainer","bottom"],[1,"buttonLight",3,"click"],[3,"onCardClicked","onEditClicked","onCardDeleted","deletable","title","description","service","image","editable"]],template:function(i,t){1&i&&(e.j41(0,"ion-content")(1,"div",0)(2,"div",1),e.nrm(3,"ion-back-button",2),e.j41(4,"h1"),e.EFF(5,"Editor"),e.k0s()(),e.j41(6,"div",3)(7,"div",3)(8,"app-actions-cards",4),e.bIt("onCardClicked",function(){return t.openModalConfigureAction(t.configuredAction)})("onEditClicked",function(){return t.openModalSwapAction(t.configuredAction)}),e.k0s(),e.nrm(9,"img",5),e.j41(10,"div",6),e.DNE(11,N,1,6,"app-actions-cards",7),e.k0s()()(),e.j41(12,"div",8)(13,"button",9),e.bIt("click",function(){return t.addNewReaction()}),e.EFF(14,"Add reaction"),e.k0s(),e.j41(15,"button",9),e.bIt("click",function(){return t.saveConfiguration()}),e.EFF(16,"Save"),e.k0s()()()()),2&i&&(e.R7$(8),e.FS9("title",null==t.configuredAction?"Unknown Service":t.configuredAction.raw.title),e.FS9("description",null==t.configuredAction?"Please select an action":t.configuredAction.raw.description),e.FS9("service",null==t.configuredAction||null==t.configuredAction.raw?null:t.configuredAction.raw.api_name),e.FS9("image",t.getimgsrc(null==t.configuredAction||null==t.configuredAction.raw?null:t.configuredAction.raw.api_name)),e.Y8G("editable",!0),e.R7$(3),e.Y8G("ngForOf",t.configuredReactions))},dependencies:[h.Sq,c.W9,c.el,v.y],styles:["ion-content[_ngcontent-%COMP%]{overflow:hidden}.container[_ngcontent-%COMP%]{width:100%;height:80%;display:flex;justify-content:center;align-content:center;align-items:center;flex-direction:row}.reactionContainer[_ngcontent-%COMP%]{height:75vh;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;overflow-y:scroll}.container-editor[_ngcontent-%COMP%]{margin-top:constant(safe-area-inset-top)!important;margin-top:env(safe-area-inset-top)!important;width:100%;height:100%;display:flex;flex-direction:column}.container-editor[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;margin-left:20px;margin-top:20px}.container-editor[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}.bottomContainer[_ngcontent-%COMP%]{height:5vh;width:80vw;margin-left:10%;margin-right:auto;display:flex;justify-content:center;align-content:center;align-items:center;flex-direction:row}img[_ngcontent-%COMP%]{width:10%;margin-left:5%;margin-right:5%;max-width:80px;max-height:80px}button[_ngcontent-%COMP%]{background:#919191;text-decoration:none;height:100%;width:30%;border-radius:10px;color:#fff;font-size:large;font-weight:700;max-width:400px;min-width:150px;margin:5%;border:none}button[_ngcontent-%COMP%]:hover{background:#636363}button[_ngcontent-%COMP%]:active{background:#424242}.ios[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]{margin-bottom:20px}@media screen and (max-width: 900px){.container[_ngcontent-%COMP%]{flex-direction:column}}"]}),r})()}];let X=(()=>{var s;class r{}return(s=r).\u0275fac=function(i){return new(i||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[m.iI.forChild($),m.iI]}),r})(),U=(()=>{var s;class r{}return(s=r).\u0275fac=function(i){return new(i||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[h.MD,C.YN,c.bv,X,v.y]}),r})()}}]);